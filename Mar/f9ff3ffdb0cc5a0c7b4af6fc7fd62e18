Hundreds of mourners packed a church service Sunday for the victims of France's latest Islamist attack, including a policeman hailed as a hero for taking the place of a hostage. Lieutenant-Colonel Arnaud Beltrame, 45, was shot and stabbed after offering himself in exchange for a woman  being used as a human shield by attacker Radouane Lakdim. Members of the Muslim community attended the service in honour of the four killed and three wounded in the attack claimed by the Islamic State group. "Your presence tells us that the creators of hatred will not win," the bishop of Carcassonne and Narbonne, Alain Planet, told the congregation at Trebes' Saint-Etienne Church. Lakdim, a Moroccan-born French national, was shot dead as police moved in to end the siege at a supermarket in the sleepy southern town of Trebes where he holed up after a shooting spree in nearby Carcassonne. Leaving the 14th-century church, Carcassonne imam Mohamed Belmihoub told reporters: "The (Muslim) community has been stabbed, Islam itself has been stabbed... by people who use symbols that are dear to our hearts." - 'All of France is unhappy' - After the mass, which had an overflow crowd listening through loudspeakers outside, pensioner Emile Acco said: "I am very sad. All of France is unhappy. We want this to end." A national tribute will be held at a later date for Beltrame, who President Emmanuel Macron said had "died a hero" and deserved "the respect and admiration of the whole nation". An autopsy has revealed the dramatic circumstances of his fatal wounding. His body was hit by non-lethal bullets and he suffered a very serious knife wound as "his trachea and larynx were slashed," a judicial source said. His death sparked a wave of emotion across France, with people leaving flowers, cards and children's drawings at gendarmes posts in his praise. "Lots of people have come to lay flowers outside barracks" in northwestern Brittany where Beltrame's mother lives, Colonel Frederic Massip told AFP. "People spontaneously approach patrolling gendarmes to express their sympathy." General Richard Lizurey, chief of staff of France's gendarmes, on Sunday addressed the Aude region's force, of which Beltrame was the third in command. "We... are proud to have counted Arnaud Beltrame in our ranks. His example must inspire us in our everyday duty," Lizurey told reporters afterward. Lakdim, 25, a petty criminal, was on a watchlist, but authorities had concluded that he did not pose a threat. - Macron accused of 'naivety' - Investigators found notes referring to IS at Lakdim's home in Carcassonne, a legal source said, including a hand-written letter in which he claimed allegiance to the jihadist group. Conservative lawmaker Geoffroy Didier criticised what he called Macron's "naivety", saying the worst jihadist attack of his presidency could have been avoided. "We have to stop being naive. The Islamic State is winning minds, we have to wake up," said Didier, a member of the right-wing Republicans party. Trebes, population 6,000, is located on the picturesque Canal du Midi, just eight kilometres (five miles) from the famed medieval walled city of Carcassonne, where a silent march is planned next Saturday, the eve of Easter Sunday. Lakdim, who was armed with a gun, knife and homemade explosive devices according to a security source, was shot dead as police moved in to end his siege of the Super U supermarket where he had holed up after a shooting spree in Carcassonne. He had hijacked a car in Carcassonne and shot the two people inside, killing the passenger and leaving the Portuguese driver in a critical condition. He also shot and wounded a police officer out jogging. Lakdim had already shot dead the supermarket's butcher and a customer when Beltrame offered to take the place of a woman he had taken hostage. Lakdim shot and stabbed the policeman before anti-terror officers killed him. Beltrame died of his wounds early Saturday, becoming the fourth victim in the shooting spree. - Petty criminal - Lakdim fit a familiar profile as a petty criminal who had turned to extremism. A small-time drug-dealer, his rap sheet included convictions for carrying a banned weapon and for drug use. He spent a month in jail in 2016. His girlfriend and a 17-year-old friend were in custody. According to a source close to the investigation, Lakdim had hinted at travelling to Syria in 2014, but did not go. France, part of the US-led coalition fighting IS, remains on high alert following a string of deadly attacks that have killed more than 240 people since 2015. During the attacks, he demanded the release of certain prisoners -- notably, according to a security source, Salah Abdeslam, the prime suspect in the November 2015 Paris terror attacks. IS claimed Friday's attack was in response to its call to target Western enemies, as is customary when the assailant has pledged allegiance to the jihadists. burs/gd/har 